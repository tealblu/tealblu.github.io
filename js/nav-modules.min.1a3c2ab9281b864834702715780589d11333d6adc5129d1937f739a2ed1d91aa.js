(()=>{(()=>{const e="navMessageRotatorState",t=()=>{if(typeof window=="undefined")return null;try{return window.localStorage}catch(e){console.warn("Nav modules localStorage access failed",e)}return null},s=()=>{const n=t();if(!n)return null;try{const s=n.getItem(e);if(!s)return null;const t=JSON.parse(s);return t&&typeof t=="object"?t:null}catch(e){console.warn("Nav modules: nav rotator state read failed",e)}return null},o=n=>{const o=t();if(!o)return;const s=e=>Number.isFinite(e)?Number(e):null,i={activeIndex:s(n?.activeIndex),lastRotationAt:s(n?.lastRotationAt),nextRotationDueAt:s(n?.nextRotationDueAt),rotationInterval:s(n?.rotationInterval),autoRotateEnabled:n?.autoRotateEnabled===!0};try{o.setItem(e,JSON.stringify(i))}catch(e){console.warn("Nav modules: nav rotator state persist failed",e)}},i=()=>{if(typeof document=="undefined")return;const t=document.getElementById("nav-message-rotator");if(!t||t.__navMessageRotatorAttached)return;const r=Array.from(t.querySelectorAll(".nav-module-message"));if(!r.length)return;let i=r.findIndex(e=>e.classList.contains("is-active"));i<0&&(i=0);const n=s();if(n&&Number.isFinite(n.activeIndex)){const e=Math.max(0,Math.min(r.length-1,n.activeIndex|0));i=e}let c=n&&Number.isFinite(n.lastRotationAt)?Number(n.lastRotationAt):null,a=n&&Number.isFinite(n.nextRotationDueAt)?Number(n.nextRotationDueAt):null;const v=n&&Number.isFinite(n.rotationInterval)?Number(n.rotationInterval):null,j=(e,n={})=>{const s=(Number(e)%r.length+r.length)%r.length;r.forEach((e,n)=>{const o=n===s;if(e.classList.toggle("is-active",o),e.setAttribute("aria-hidden",o?"false":"true"),o){t.dataset.activeIndex=String(n);const s=typeof e.dataset.label=="string"?e.dataset.label:"",o=(e.textContent||"").trim();s?t.title=s:o?t.title=o:t.removeAttribute("title")}}),i=s;const o=Number.isFinite(n?.rotationAt)?Number(n.rotationAt):Date.now();c=o};let e=Number.parseInt(t.dataset.rotationInterval||"",10);(!Number.isFinite(e)||e<=0)&&(e=Number.isFinite(v)&&v>0?v|0:NaN);const m=typeof window!="undefined"&&typeof window.matchMedia=="function"?window.matchMedia("(prefers-reduced-motion: reduce)"):null,u=Number.isFinite(e)&&e>0;u&&(e=Math.max(1,e|0));let l=u&&!(m&&m.matches),g=null;const h=()=>{o({activeIndex:i,lastRotationAt:c,nextRotationDueAt:a,rotationInterval:u?e:null,autoRotateEnabled:l})},d=Date.now();let f=null;if(l&&u)if(Number.isFinite(a)){let t=a,n=i;for(;t<=d;)t+=e,n=(n+1)%r.length;a=t,c=t-e,i=n,f=t-d}else if(Number.isFinite(c)){const t=Math.max(0,d-c);if(t>=e){const n=Math.floor(t/e);n>0&&(i=(i+n)%r.length,c+=n*e)}const s=Math.max(0,d-c),n=e-s;f=n>0?n:e,a=d+f}else c=d,f=e,a=d+e;else a=null;const O=Number.isFinite(c)?Number(c):Date.now();j(i,{rotationAt:O}),h();const b=()=>{g!==null&&(window.clearTimeout(g),g=null)},y=()=>{const e=(i+1)%r.length;j(e),a=null,h()},p=t=>{if(!l)return;b();const s=u?Math.max(e,1e3):4e3,o=Number.isFinite(t)?Number(t):s,n=Math.max(o,100);a=Date.now()+n,h(),g=window.setTimeout(()=>{y(),p()},n)},_=()=>{if(!l)return;b(),a=null,h()},w=()=>{if(!l)return;p()};t.addEventListener("click",()=>{y(),l&&p()}),m&&typeof m.addEventListener=="function"&&m.addEventListener("change",e=>{l=u&&!e.matches,l?p():(b(),a=null,h())}),l?(p(f),t.addEventListener("mouseenter",_),t.addEventListener("focus",_),t.addEventListener("mouseleave",w),t.addEventListener("blur",w)):h(),t.__navMessageRotatorAttached=!0},n=(e,t)=>{if(!e||typeof e[t]!="function")return;try{e[t]()}catch(e){console.warn(`Nav modules: ${t} failed`,e)}},a=()=>{if(typeof document=="undefined")return;n(window?.coffeeModule,"initializeCoffeeMessage"),n(window?.weatherModule,"initializeWeatherMessage"),i()};typeof document!="undefined"&&document.addEventListener("DOMContentLoaded",a)})()})()