(()=>{(()=>{const e=1440,t=(e,t)=>{if(typeof e=="number"&&Number.isFinite(e))return e|0;if(typeof e=="string"&&e.trim().length>0){const t=Number.parseInt(e.trim(),10);if(Number.isFinite(t))return t}return t},n=e=>{if(typeof e!="string")return null;const o=e.trim();if(o.length===0)return null;const s=o.match(/^(\d{1,2}):(\d{2})$/);if(!s)return null;const t=Number.parseInt(s[1],10),n=Number.parseInt(s[2],10);return!Number.isFinite(t)||!Number.isFinite(n)?null:t<0||t>23||n<0||n>59?null:t*60+n},s=()=>{const e=new Date;return e.getHours()*60+e.getMinutes()+e.getSeconds()/60},o=(t,n,s)=>{if(!Number.isFinite(t)||!Number.isFinite(n)||!Number.isFinite(s))return null;const r=t=>{const n=t%e;return n<0?n+e:n},i=r(t),o=r(n),a=r(s),c=(a-o+e)%e;if(c===0)return null;if(a>o)return i<=o?0:i>=a?1:(i-o)/(a-o);if(i>=o||i<=a){const t=i>=o?i-o:i+e-o;return t/c}return 0},i=e=>{if(typeof e!="string"||e.trim().length===0)return"Coffee tracker";const t=e.trim();return`${t.charAt(0).toUpperCase()}${t.slice(1)} tracker`},a=()=>{if(typeof document=="undefined")return;const e=document.getElementById("nav-message-rotator");if(!e||e.dataset.coffeeEnabled!=="true")return;if(e.querySelector('[data-coffee-message="true"]'))return;const h=Array.from(e.querySelectorAll(".nav-module-message")),a=document.createElement("span");a.className="nav-module-message",a.dataset.index=String(h.length),a.dataset.coffeeMessage="true";const r=typeof e.dataset.coffeeLabel=="string"&&e.dataset.coffeeLabel.trim().length>0?e.dataset.coffeeLabel.trim():"";if(r){a.dataset.label=r;const e=document.createElement("span");e.className="nav-module-label",e.textContent=r,a.appendChild(e)}const l=document.createElement("span");l.className="nav-module-text",l.textContent="Tracking coffeeâ€¦",a.appendChild(l),h.length||a.classList.add("is-active"),e.appendChild(a);const c=Math.max(0,t(e.dataset.coffeeMin,0)),m=Math.max(c,t(e.dataset.coffeeMax,Math.max(c,5))),p=typeof e.dataset.coffeeUnitSingular=="string"&&e.dataset.coffeeUnitSingular.trim().length>0?e.dataset.coffeeUnitSingular.trim():"cup",g=typeof e.dataset.coffeeUnitPlural=="string"&&e.dataset.coffeeUnitPlural.trim().length>0?e.dataset.coffeeUnitPlural.trim():"cups",d=typeof e.dataset.coffeeBeverage=="string"&&e.dataset.coffeeBeverage.trim().length>0?e.dataset.coffeeBeverage.trim():"coffee",f=typeof e.dataset.coffeeVerb=="string"&&e.dataset.coffeeVerb.trim().length>0?e.dataset.coffeeVerb.trim():"consumed today",u=r||i(d);try{const h=n(e.dataset.coffeeFirstTime),v=n(e.dataset.coffeeLastTime),b=m-c;let t=c;if(h!==null&&v!==null){const e=o(s(),h,v);if(e!==null){const n=Math.min(1,Math.max(0,e)),s=c+n*b;t=Math.round(s)}}t=Math.min(m,Math.max(c,t));const j=t===1?p:g,i=[`${t} ${j}`];d&&i.push(`of ${d}`),f&&i.push(f),l.textContent=i.join(" "),r||(a.dataset.label=u)}catch(e){console.warn("Coffee tracker update failed",e),l.textContent=`${u}: unavailable`,r||(a.dataset.label=u)}};typeof window!="undefined"&&(window.coffeeModule=window.coffeeModule||{},window.coffeeModule.initializeCoffeeMessage=a)})()})()