(()=>{(()=>{const i=1440,e=(e,t)=>{if(typeof e=="number"&&Number.isFinite(e))return e|0;if(typeof e=="string"&&e.trim().length>0){const t=Number.parseInt(e.trim(),10);if(Number.isFinite(t))return t}return t},t=(e,t)=>{const n=t-e+1;return n<=0?e:e+Math.floor(Math.random()*n)},n=(e,n)=>{const o=getTodayKey(),s=readStoredState();if(s&&s.date===o&&s.count>=e&&s.count<=n)return s.count;const i=t(e,n);return persistState({date:o,count:i}),i},s=e=>{if(typeof e!="string"||e.trim().length===0)return"Coffee tracker";const t=e.trim();return`${t.charAt(0).toUpperCase()}${t.slice(1)} tracker`},o=()=>{if(typeof document=="undefined")return;const t=document.getElementById("nav-message-rotator");if(!t||t.dataset.coffeeEnabled!=="true")return;if(t.querySelector('[data-coffee-message="true"]'))return;const d=Array.from(t.querySelectorAll(".nav-module-message")),o=document.createElement("span");o.className="nav-module-message",o.dataset.index=String(d.length),o.dataset.coffeeMessage="true";const i=typeof t.dataset.coffeeLabel=="string"&&t.dataset.coffeeLabel.trim().length>0?t.dataset.coffeeLabel.trim():"";if(i){o.dataset.label=i;const e=document.createElement("span");e.className="nav-module-label",e.textContent=i,o.appendChild(e)}const a=document.createElement("span");a.className="nav-module-text",a.textContent="Tracking coffeeâ€¦",o.appendChild(a),d.length||o.classList.add("is-active"),t.appendChild(o);const r=Math.max(0,e(t.dataset.coffeeMin,0)),h=Math.max(r,e(t.dataset.coffeeMax,Math.max(r,5))),m=typeof t.dataset.coffeeUnitSingular=="string"&&t.dataset.coffeeUnitSingular.trim().length>0?t.dataset.coffeeUnitSingular.trim():"cup",f=typeof t.dataset.coffeeUnitPlural=="string"&&t.dataset.coffeeUnitPlural.trim().length>0?t.dataset.coffeeUnitPlural.trim():"cups",c=typeof t.dataset.coffeeBeverage=="string"&&t.dataset.coffeeBeverage.trim().length>0?t.dataset.coffeeBeverage.trim():"coffee",u=typeof t.dataset.coffeeVerb=="string"&&t.dataset.coffeeVerb.trim().length>0?t.dataset.coffeeVerb.trim():"consumed today",l=i||s(c);try{const t=n(r,h),s=t===1?m:f,e=[`${t} ${s}`];c&&e.push(`of ${c}`),u&&e.push(u),a.textContent=e.join(" "),i||(o.dataset.label=l)}catch(e){console.warn("Coffee tracker update failed",e),a.textContent=`${l}: unavailable`,i||(o.dataset.label=l)}};typeof window!="undefined"&&(window.coffeeModule=window.coffeeModule||{},window.coffeeModule.initializeCoffeeMessage=o)})()})()